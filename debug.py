import io
from struct import pack
from xml_parser import XmlParser

packet = bytes.fromhex('56020b0173040b0161065608440a1e0082990d52656c61796564416363657074440c1e00829946687474703a2f2f736368656d61732e6d6963726f736f66742e636f6d2f323030352f31322f536572766963654d6f64656c2f41646472657373696e672f416e6f6e796d6f757301560e400d52656c617965644163636570740843687474703a2f2f736368656d61732e6d6963726f736f66742e636f6d2f6e657473657276696365732f323030392f30352f736572766963656275732f636f6e6e65637409016929687474703a2f2f7777772e77332e6f72672f323030312f584d4c536368656d612d696e7374616e636540024964992461376438373462352d666665302d343463362d616137632d646639636331303036336336010101')

# packet = bytes.fromhex('06e3010056020b0173040b0161065608440a1e0082ab9a05441aad2a9c2ee875ae6f4281135d77d964a74d440c1e0082998a73623a2f2f6869732d73622d68697367656e6572616c2d6575722d6e657572312e736572766963656275732e77696e646f77732e6e65742f65343638363665392d346230302d343534342d626265362d3564656463663365326663665f34643864373136372d333863332d343461312d383264302d3830666162313336303463385f72656c6961626c6501560e4298050a20429405442aab140142b205421ead1ccbb04b32495d4782640809dab6df8a01010101')

# packet = bytes.fromhex('0001000102028a0173623a2f2f6869732d73622d68697367656e6572616c2d6575722d6e657572312e736572766963656275732e77696e646f77732e6e65742f65343638363665392d346230302d343534342d626265362d3564656463663365326663665f34643864373136372d333863332d343461312d383264302d3830666162313336303463385f72656c6961626c6503080c')

xml = XmlParser(io.BytesIO(packet)).unserialize()
print(xml)